labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(label = after_stat(y), group = CUR1),
stat = 'summary', fun = round(sum))
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(count)
), stat = 'count', nudge_y = 0.1
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(count)
), stat = 'count'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(CUR1)
), stat = 'count'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(y)
), stat = 'count'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(y)
), stat = 'summary', fun = 'sum'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(y)
), stat = 'summary', fun = 'count'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(y)
), stat = 'count'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = after_stat(y)
), stat = 'identity'
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text()
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
stat_summary(
aes(label = stat(y), fun.y = 'sum', geom = 'text')
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
stat_summary(
aes(label = stat(x), fun.x = 'sum', geom = 'text')
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
stat_summary(
aes(label = stat(y), fun.y = 'sum', geom = 'text')
)
)
}
?stat_summary
?geom_text
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = y
)
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = CUR1
)
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = sum(FINALWT)
)
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response") +
geom_text(
aes(
label = count(FINALWT)
)
)
)
}
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
)
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
`%nin%` <- Negate(`%in%`)
questions <- colnames(df) %nin% variables
questions
variables
variables <- c("POLITICS","DEMO","REPUB","INDEP","IDEO","URBAN","MARITAL","AGEGRP","EDUCATION","RACETH","GENDER","HHINCOME","EMPSTATUS","STATE","CENSUS_REGION")
questions <- colnames(df) %nin% variables
questions
df <- read.csv("APNORC_june2021_PUF.csv")
colnames(df)
questions <- colnames(df)[!(colnames(df) %in% variables)]
methodological <- c("SU_ID","FINALWT")
variables <- c("POLITICS","DEMO","REPUB","INDEP","IDEO","URBAN","MARITAL","AGEGRP","EDUCATION","RACETH","GENDER","HHINCOME","EMPSTATUS","STATE","CENSUS_REGION","SURV_MODE","SURV_LANG")
questions <- colnames(df)[!(colnames(df) %in% variables)]
methodological <- c("SU_ID","FINALWT")
variables <- c("POLITICS","DEMO","REPUB","INDEP","IDEO","URBAN","MARITAL","AGEGRP","EDUCATION","RACETH","GENDER","HHINCOME","EMPSTATUS","STATE","CENSUS_REGION","SURV_MODE","SURV_LANG")
questions <- colnames(df)[!(colnames(df) %in% variables)|!(colnames(df) %in% methodological)]
questions <- colnames(df)[!(colnames(df) %in% variables)&!(colnames(df) %in% methodological)]
print(
ggplot(df, aes(fill=CUR1, y = FINALWT) +
facet_wrap(vars(variables))
geom_bar(position = "fill", stat = "identity") +
print(
ggplot(df, aes(fill=CUR1, y = FINALWT) +
facet_wrap(vars(variables)) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT) +
facet_wrap(vars(variables)) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
))
ggplot(df, aes(fill=CUR1, y = FINALWT) +
facet_wrap(vars(variables)) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
ggplot(df, aes(fill=CUR1, y = FINALWT) +
facet_wrap(vars(colnames(df)[colnames(df) %in% variables])) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
ggplot(df, aes(fill=CUR1, y = FINALWT)) +
facet_wrap(vars(colnames(df)[colnames(df) %in% variables])) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
print(
ggplot(df, aes(fill=CUR1, y = FINALWT) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT)) +
geom_bar(position = "fill", stat = "identity") +
facet_wrap(vars('POLITICS','RACETH')) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT)) +
geom_bar(position = "fill", stat = "identity") +
#facet_wrap(vars('POLITICS','RACETH')) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
ggplot(df, aes(fill=CUR1, y = FINALWT), x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
print(
ggplot(df, aes(fill=CUR1, y = FINALWT), x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]])) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
print(
ggplot(df, aes(fill=CUR1, y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
questions
for (quex in questions) {
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=df[[quex]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
}
questions <- questions[1:2]
for (quex in questions) {
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=df[[quex]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
}
questions <- colnames(df)[!(colnames(df) %in% variables)&!(colnames(df) %in% methodological)]
question <- c("CURY2D")
lapply(question,function(question, variables) {
print(variables)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[variables]] == toupper(df[[variables]]), "(5) Missing", df[[variables]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
})
lapply(question,function(question, variables) {
print(variables)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[variables]] == toupper(df[[variables]]), "(5) Missing", df[[variables]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(variables), y = "PROPORTION", fill = "Response")
)
})
lapply(question,function(question, variables) {
for (varx in variables) {
print(variables)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
})
lapply(question,function(question) {
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
})
methodological <- c("SU_ID","FINALWT")
variables <- c("POLITICS","DEMO","REPUB","INDEP","IDEO","URBAN","MARITAL","AGEGRP","EDUCATION","RACETH","GENDER","HHINCOME","EMPSTATUS","CENSUS_REGION","SURV_MODE","SURV_LANG")
questions <- colnames(df)[!(colnames(df) %in% variables)&!(colnames(df) %in% methodological)&colnames(df)!="STATE"]
table(df$CURY2D)
library(knitr)
?knitr
question <- c("CURY2D")
lapply(question,function(question) {
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
})
question <- c("CURY2D")
variables <- "POLITICS"
lapply(question,function(question) {
for (varx in variables) {
print(varx)
print(
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
)
}
})
install.packages("htmlwidgets")
lapply(question,function(question) {
for (varx in variables) {
print(varx)
gg <-
ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
#coord_flip() +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
}
})
lapply(question,function(question) {
for (varx in variables) {
print(varx)
gg <- ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
}
})
gg <- ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
saveWidget(ggplotly(gg), file = "test.html")
library(htmlwidgets)
saveWidget(ggplotly(gg), file = "test.html")
install.packages("plotly")
library(plotly)
saveWidget(ggplotly(gg), file = "test.html")
gg
variables <- "POLITICS"
lapply(question,function(question) {
for (varx in variables) {
print(varx)
gg <- ggplot(df, aes(fill=df[[question]], y = FINALWT, x = ifelse(df[[varx]] == toupper(df[[varx]]), "(5) Missing", df[[varx]]))) +
geom_bar(position = "fill", stat = "identity") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
labs(x = paste(varx), y = "PROPORTION", fill = "Response")
saveWidget(ggplotly(gg), file = "test.html")
}
})
install.packages("camelot")
